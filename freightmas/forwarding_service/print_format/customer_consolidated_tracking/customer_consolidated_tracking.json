{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-11-15 19:08:03.099965",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Customer",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- set no_default_print_heading = 1 -%}\n{% set active_jobs = frappe.get_all('Forwarding Job', \n    filters={\n        'customer': doc.name,\n        'status': ['in', ['Draft', 'In Progress', 'Delivered']],\n        'docstatus': ['<', 2]\n    },\n    fields=[\n        'name', 'date_created', 'customer_reference', 'direction', 'shipment_mode', 'shipment_type',\n        'status', 'port_of_loading', 'port_of_discharge', 'destination', 'cargo_description',\n        'bl_number', 'etd', 'eta', 'ata', 'vessel_flight_no', 'modified', 'current_comment',\n        'last_updated_on', 'bl_confirmed_date', 'discharge_date', 'completed_on', 'cargo_count'\n    ],\n    order_by='date_created desc'\n) %}\n\n<div class=\"print-format\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: Arial, sans-serif; font-size: 10px; color: #000; line-height: 1.2; background: #fff; }\n    .print-format { width: 100%; max-width: 100%; padding: 10px; }\n    \n    @page { size: A4; margin: 15mm; }\n    \n    .header-title { \n      text-align: center; \n      font-size: 16px; \n      font-weight: 700; \n      margin-bottom: 8px; \n      text-transform: uppercase; \n      color: #000;\n      letter-spacing: 0.3px;\n    }\n    \n    .header-subtitle {\n      text-align: center;\n      font-size: 12px;\n      color: #000;\n      margin-bottom: 20px;\n      line-height: 1.3;\n    }\n    \n    .section-title { \n      font-weight: 700; \n      font-size: 11px; \n      margin: 12px 0 6px 0; \n      text-transform: uppercase; \n      color: #000;\n      background: #fff;\n      border-bottom: 2px solid #000;\n      padding: 5px 8px;\n      letter-spacing: 0.2px;\n    }\n    \n    .job-separator {\n      border-top: 3px solid #2E86AB;\n      margin: 25px 0 15px 0;\n      padding-top: 15px;\n    }\n    \n    .job-title {\n      font-size: 14px;\n      font-weight: bold;\n      color: #2E86AB;\n      margin-bottom: 8px;\n      text-align: center;\n    }\n    \n    .summary-table, .charge-table, .party-table { \n      width: 100%; \n      border-collapse: collapse; \n      margin-bottom: 12px;\n      border: 1px solid #000;\n      background: #fff;\n      font-size: 10px;\n    }\n    \n    .summary-table th, .charge-table th, .party-table th { \n      background-color: #fff; \n      color: #000;\n      padding: 4px 6px; \n      border: 1px solid #000;\n      text-align: center; \n      font-weight: 700; \n      font-size: 10px;\n      text-transform: uppercase;\n      letter-spacing: 0.1px;\n      white-space: normal;\n      word-wrap: break-word;\n      line-height: 1.1;\n    }\n    \n    .summary-table th:first-child, .charge-table th:first-child, .party-table th:first-child {\n      text-align: left;\n    }\n    \n    .summary-table td, .charge-table td, .party-table td { \n      padding: 3px 6px; \n      border: 1px solid #000; \n      text-align: center; \n      font-size: 10px;\n      line-height: 1.1;\n      vertical-align: top;\n    }\n    \n    .summary-table td:first-child,\n    .charge-table td:first-child, \n    .party-table td:first-child { \n      text-align: left; \n      font-weight: 500;\n    }\n    \n    .party-table td:last-child {\n      text-align: left;\n      word-wrap: break-word;\n      white-space: normal;\n      max-width: 200px;\n      font-size: 10px;\n      line-height: 1.2;\n    }\n    \n    .party-table th:last-child {\n      text-align: left;\n    }\n    \n    .border-milestone {\n      font-size: 9px;\n      padding: 2px 4px;\n    }\n    \n    .footer { \n      margin-top: 20px; \n      text-align: center; \n      font-size: 10px; \n      color: #000; \n      border-top: 1px solid #000; \n      padding-top: 8px;\n    }\n    \n    @media print { \n      body { padding: 5px; margin: 0; }\n      .print-format { padding: 5px; }\n      .page-break { page-break-before: always; }\n      .job-separator { page-break-before: always; }\n      .summary-table, .charge-table, .party-table { page-break-inside: avoid; }\n    }\n  </style>\n\n  <!-- Main Header -->\n  <div class=\"header-title\">{{ doc.company or \"FreightMas\" }} - Consolidated Tracking Report</div>\n  <div class=\"header-subtitle\">\n    Customer: {{ doc.customer_name }}<br>\n    Report Generated: {{ frappe.utils.format_datetime(frappe.utils.now(), \"dd-MMM-yyyy HH:mm\") }}<br>\n    Total Active Jobs: {{ active_jobs|length }}\n  </div>\n\n  {% if active_jobs %}\n    <!-- Summary Section -->\n    <div class=\"section-title\">\ud83d\udcca Jobs Summary</div>\n    <table class=\"summary-table\">\n      <thead>\n        <tr>\n          <th style=\"width:15%;\">Job ID</th>\n          <th style=\"width:15%;\">Reference</th>\n          <th style=\"width:20%;\">Direction</th>\n          <th style=\"width:25%;\">Route</th>\n          <th style=\"width:15%;\">Status</th>\n          <th style=\"width:10%;\">ETA</th>\n        </tr>\n      </thead>\n      <tbody>\n        {% for job in active_jobs %}\n          {% set direction_display = (job.shipment_mode or '') + ' ' + (job.shipment_type or '') + ' ' + (job.direction or '') %}\n          {% set route_display = (job.port_of_loading or '') + ' \u2192 ' + (job.port_of_discharge or job.destination or '') %}\n          <tr>\n            <td style=\"font-weight: bold;\">{{ job.name }}</td>\n            <td>{{ job.customer_reference or '\u2014' }}</td>\n            <td>{{ direction_display.strip() }}</td>\n            <td>{{ route_display }}</td>\n            <td style=\"font-weight: bold;\">{{ job.status }}</td>\n            <td>{{ frappe.utils.formatdate(job.eta, 'dd-MMM-yy') if job.eta else '\u2014' }}</td>\n          </tr>\n        {% endfor %}\n      </tbody>\n    </table>\n\n    <!-- Detailed Tracking Section -->\n    {% for job in active_jobs %}\n      {% set job_doc = frappe.get_doc('Forwarding Job', job.name) %}\n      {% set containers = job_doc.cargo_parcel_details or [] %}\n      \n      <div class=\"{% if loop.index > 1 %}job-separator{% endif %}\">\n        <div class=\"job-title\">JOB {{ loop.index }}: {{ job.name }} - {{ job.customer_reference or 'No Reference' }}</div>\n        \n        <!-- Job Header Info -->\n        <div style=\"text-align: center; font-size: 11px; margin-bottom: 12px; line-height: 1.3;\">\n          Mode: {{ (job.shipment_mode or \"Sea\") ~ \" \" ~ (job.direction or \"Import\") }} | Date Created: {{ frappe.utils.formatdate(job.date_created, \"dd-MMM-yy\") if job.date_created else \"\u2014\" }}<br>\n          Route: {{ job.port_of_loading or \"\u2014\" }} \u2192 {{ job.destination or job.port_of_discharge or \"\u2014\" }} | Cargo Count: {{ job.cargo_count or \"\u2014\" }}\n        </div>\n        \n        <!-- Job Tracking Status -->\n        <div class=\"section-title\">Job Tracking Status</div>\n        <table class=\"summary-table\">\n          <thead>\n            <tr>\n              <th style=\"width:20%;\">STATUS</th>\n              <th style=\"width:50%; text-align:left;\">CURRENT MILESTONE</th>\n              <th style=\"width:30%;\">LAST UPDATED ON</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td style=\"text-align:left; font-weight:bold;\">{{ job_doc.status or \"\u2014\" }}</td>\n              <td style=\"text-align:left;\">{{ job_doc.current_comment or \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(job_doc.last_updated_on, \"dd-MMM-yy\") if job_doc.last_updated_on else \"\u2014\" }}</td>\n            </tr>\n          </tbody>\n        </table>\n        \n        <!-- Key Dates Timeline -->\n        <div class=\"section-title\">Key Dates Timeline</div>\n        <table class=\"charge-table\">\n          <thead>\n            <tr>\n              <th style=\"width:20%;\">ETA</th>\n              <th style=\"width:20%;\">ATA</th>\n              <th style=\"width:20%;\">BL CONFIRMED ON</th>\n              <th style=\"width:20%;\">DISCHARGED ON</th>\n              <th style=\"width:20%;\">COMPLETED ON</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>{{ frappe.utils.formatdate(job_doc.eta, \"dd-MMM-yy\") if job_doc.eta else \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(job_doc.ata, \"dd-MMM-yy\") if job_doc.ata else \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(job_doc.bl_confirmed_date, \"dd-MMM-yy\") if job_doc.bl_confirmed_date else \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(job_doc.discharge_date, \"dd-MMM-yy\") if job_doc.discharge_date else \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(job_doc.completed_on, \"dd-MMM-yy\") if job_doc.completed_on else \"\u2014\" }}</td>\n            </tr>\n          </tbody>\n        </table>\n        \n        <!-- Cargo Tracking Details -->\n        <div class=\"section-title\">Cargo Tracking Details</div>\n        <table class=\"party-table\">\n          <thead>\n            <tr>\n              <th style=\"width:14%;\">CARGO/CONTAINER</th>\n              <th style=\"width:10%;\">LOADED ON</th>\n              {%- set has_border_1 = containers | selectattr(\"border_tracking\") | list | length > 0 -%}\n              {%- set has_border_2 = containers | selectattr(\"border_2_tracking\") | list | length > 0 -%}\n              {%- set has_offloading_point = containers | selectattr(\"offloading_point\", \"equalto\", 1) | list | length > 0 -%}\n              {% if has_border_1 %}<th class=\"border-milestone\" style=\"width:8%;\">BORDER 1</th>{% endif %}\n              {% if has_border_2 %}<th class=\"border-milestone\" style=\"width:8%;\">BORDER 2</th>{% endif %}\n              {% if has_offloading_point %}<th class=\"border-milestone\" style=\"width:8%;\">OFFLOADING POINT</th>{% endif %}\n              <th style=\"width:10%;\">OFFLOADED ON</th>\n              <th style=\"width:10%;\">RETURNED ON</th>\n              <th style=\"width:10%;\">COMPLETED ON</th>\n              <th style=\"width:{% if has_border_1 or has_border_2 or has_offloading_point %}26{% else %}44{% endif %}%;\">TRACKING COMMENT</th>\n            </tr>\n          </thead>\n          <tbody>\n            {% for row in containers %}\n            <tr>\n              <td style=\"text-align:left;\">\n                {%- if row.cargo_type == \"Containerised\" or row.cargo_type == \"General Cargo\" -%}\n                  {{ row.container_number or \"\u2014\" }}\n                {%- else -%}\n                  {{ row.cargo_item_description or \"\u2014\" }}\n                {%- endif -%}\n              </td>\n              <td>{{ frappe.utils.formatdate(row.loaded_on_date, \"dd-MMM-yy\") if row.loaded_on_date else \"\u2014\" }}</td>\n              {% if has_border_1 %}\n              <td class=\"border-milestone\" style=\"font-size:10px; line-height:1.2;\">\n                {%- if row.border_tracking and row.border_name -%}\n                  {{ row.border_name }}<br>\n                  {%- if row.border_arrived_on -%}\n                    In: {{ frappe.utils.formatdate(row.border_arrived_on, \"dd-MMM\") }}\n                  {%- endif -%}\n                  {%- if row.border_left_on -%}\n                    {%- if row.border_arrived_on -%}<br>{%- endif -%}\n                    Out: {{ frappe.utils.formatdate(row.border_left_on, \"dd-MMM\") }}\n                  {%- endif -%}\n                {%- else -%}\n                  \u2014\n                {%- endif -%}\n              </td>\n              {% endif %}\n              {% if has_border_2 %}\n              <td class=\"border-milestone\" style=\"font-size:10px; line-height:1.2;\">\n                {%- if row.border_2_tracking and row.border_2_name -%}\n                  {{ row.border_2_name }}<br>\n                  {%- if row.border_2_arrived_on -%}\n                    In: {{ frappe.utils.formatdate(row.border_2_arrived_on, \"dd-MMM\") }}\n                  {%- endif -%}\n                  {%- if row.border_2_left_on -%}\n                    {%- if row.border_2_arrived_on -%}<br>{%- endif -%}\n                    Out: {{ frappe.utils.formatdate(row.border_2_left_on, \"dd-MMM\") }}\n                  {%- endif -%}\n                {%- else -%}\n                  \u2014\n                {%- endif -%}\n              </td>\n              {% endif %}\n              {% if has_offloading_point %}\n              <td class=\"border-milestone\" style=\"font-size:10px; line-height:1.2;\">\n                {{ frappe.utils.formatdate(row.offloading_arrived_on, \"dd-MMM-yy\") if row.offloading_arrived_on else \"\u2014\" }}\n              </td>\n              {% endif %}\n              <td>{{ frappe.utils.formatdate(row.offloaded_on_date, \"dd-MMM-yy\") if row.offloaded_on_date else \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(row.returned_on_date, \"dd-MMM-yy\") if row.returned_on_date else \"\u2014\" }}</td>\n              <td>{{ frappe.utils.formatdate(row.completed_on_date, \"dd-MMM-yy\") if row.completed_on_date else \"\u2014\" }}</td>\n              <td style=\"text-align:left;\">{{ row.tracking_comment or \"\u2014\" }}</td>\n            </tr>\n            {% endfor %}\n            {% if not containers %}\n            <tr>\n              <td colspan=\"{{ 7 + (1 if has_border_1 else 0) + (1 if has_border_2 else 0) + (1 if has_offloading_point else 0) }}\" style=\"text-align: center; font-style: italic; color: #666;\">\n                No cargo details available\n              </td>\n            </tr>\n            {% endif %}\n          </tbody>\n        </table>\n      </div>\n    {% endfor %}\n  {% else %}\n    <div style=\"text-align: center; padding: 50px 20px; color: #666;\">\n      <h3>No Active Jobs Found</h3>\n      <p>This customer currently has no active forwarding jobs.</p>\n    </div>\n  {% endif %}\n\n  <!-- Footer -->\n  <div class=\"footer\">\n    <p>FreightMas Logistics - Generated on {{ frappe.utils.formatdate(frappe.utils.now(), \"dd-MMM-yy\") }}</p>\n  </div>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-11-15 19:47:04.120764",
 "modified_by": "Administrator",
 "module": "Forwarding Service",
 "name": "Customer Consolidated Tracking",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}