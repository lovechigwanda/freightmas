{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-11-08 23:06:50.923254",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Forwarding Job",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<!-- Forwarding Job Cost Sheet - Enhanced with Utility Functions -->\n{%- set no_default_print_heading = 1 -%}\n{% set cost_data = frappe.call('freightmas.utils.fwjb_cost_sheet_calc.get_charge_details_for_cost_sheet', job_name=doc.name) or {} %}\n{% set party_data = frappe.call('freightmas.utils.fwjb_cost_sheet_calc.get_party_details_for_cost_sheet', job_name=doc.name) or {} %}\n{% set totals = frappe.call('freightmas.utils.fwjb_cost_sheet_calc.get_job_totals_summary', job_name=doc.name) or {} %}\n<div class=\"print-format\">\n  <style>\n    body { font-family: Arial, sans-serif; font-size: 10px; margin: 0; padding: 15px; color: #333; }\n    .header-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; border: 1px solid #ddd; }\n    .header-table td { padding: 8px; border: 1px solid #ddd; vertical-align: top; }\n    .header-title { text-align: center; font-size: 16px; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; }\n    .summary-table, .charge-table, .party-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; border: 1px solid #333; }\n    .summary-table th, .charge-table th, .party-table th { background-color: #f0f0f0; padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold; font-size: 9px; }\n    .summary-table td, .charge-table td, .party-table td { padding: 6px 8px; border: 1px solid #333; text-align: right; font-size: 10px; }\n    .charge-table td:first-child, .party-table td:first-child, .charge-table td:nth-child(2), .charge-table td:nth-child(3) { text-align: left; }\n    .total-row { background-color: #f5f5f5; font-weight: bold; }\n    .positive { color: #008000; }\n    .negative { color: #d00; }\n    .section-title { font-weight: bold; font-size: 12px; margin: 15px 0 8px 0; text-transform: uppercase; border-left: 3px solid #333; padding-left: 8px; background-color: #f9f9f9; }\n    .number { text-align: right; font-family: 'Courier New', monospace; }\n    @media print { body { padding: 10px; } .page-break { page-break-after: always; } }\n  </style>\n  <div class=\"header-title\">{{ doc.company or \"FreightMas\" }} - Forwarding Job Cost Sheet</div>\n  <table class=\"header-table\">\n    <tr><td style=\"width:15%; font-weight:bold;\">Job No:</td><td style=\"width:35%;\">{{ doc.name }}</td><td style=\"width:15%; font-weight:bold;\">Date:</td><td style=\"width:35%;\">{{ doc.date_created }}</td></tr>\n    <tr><td style=\"font-weight:bold;\">Customer:</td><td>{{ doc.customer }}</td><td style=\"font-weight:bold;\">Mode:</td><td>{{ (doc.shipment_mode or \"Sea\") ~ \" \" ~ (doc.direction or \"Import\") }}</td></tr>\n    <tr><td style=\"font-weight:bold;\">Customer Ref:</td><td>{{ doc.customer_reference or \"\u2014\" }}</td><td style=\"font-weight:bold;\">Status:</td><td>{{ doc.status or \"Draft\" }}</td></tr>\n  </table>\n  <div class=\"section-title\">Costing Summary: Quoted vs Working vs Invoiced</div>\n  <table class=\"summary-table\">\n    <thead><tr><th>METRIC</th><th>QUOTED</th><th>WORKING</th><th>INVOICED</th><th>VARIANCE (INV-QT)</th><th>VARIANCE %</th></tr></thead>\n    <tbody>\n      <tr><td style=\"text-align:left; font-weight:bold;\">Revenue</td><td class=\"number\">{{ \"{:,.0f}\".format(doc.total_quoted_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(doc.total_working_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(totals.invoiced_revenue or 0) }}</td><td class=\"number {% if (totals.invoiced_revenue or 0) - (doc.total_quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((totals.invoiced_revenue or 0) - (doc.total_quoted_revenue or 0)) }}</td><td class=\"number {% if (totals.invoiced_revenue or 0) - (doc.total_quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{% if (doc.total_quoted_revenue or 0) > 0 %}{{ \"%.1f\"|format(((totals.invoiced_revenue or 0) - (doc.total_quoted_revenue or 0)) / (doc.total_quoted_revenue or 1) * 100) }}%{% else %}\u2014{% endif %}</td></tr>\n      <tr><td style=\"text-align:left; font-weight:bold;\">Cost</td><td class=\"number\">{{ \"{:,.0f}\".format(doc.total_quoted_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(doc.total_working_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(totals.invoiced_cost or 0) }}</td><td class=\"number {% if (totals.invoiced_cost or 0) - (doc.total_quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((totals.invoiced_cost or 0) - (doc.total_quoted_cost or 0)) }}</td><td class=\"number {% if (totals.invoiced_cost or 0) - (doc.total_quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{% if (doc.total_quoted_cost or 0) > 0 %}{{ \"%.1f\"|format(((totals.invoiced_cost or 0) - (doc.total_quoted_cost or 0)) / (doc.total_quoted_cost or 1) * 100) }}%{% else %}\u2014{% endif %}</td></tr>\n      <tr class=\"total-row\"><td style=\"text-align:left; font-weight:bold;\">Margin</td><td class=\"number\">{{ \"{:,.0f}\".format((doc.total_quoted_revenue or 0) - (doc.total_quoted_cost or 0)) }}</td><td class=\"number\">{{ \"{:,.0f}\".format((doc.total_working_revenue or 0) - (doc.total_working_cost or 0)) }}</td><td class=\"number\">{{ \"{:,.0f}\".format((totals.invoiced_revenue or 0) - (totals.invoiced_cost or 0)) }}</td><td class=\"number {% if ((totals.invoiced_revenue or 0) - (totals.invoiced_cost or 0)) - ((doc.total_quoted_revenue or 0) - (doc.total_quoted_cost or 0)) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format(((totals.invoiced_revenue or 0) - (totals.invoiced_cost or 0)) - ((doc.total_quoted_revenue or 0) - (doc.total_quoted_cost or 0))) }}</td><td class=\"number\">\u2014</td></tr>\n      <tr class=\"total-row\"><td style=\"text-align:left; font-weight:bold;\">Margin %</td><td class=\"number\">{{ \"%.1f\"|format(totals.quoted_margin_percent or 0) }}%</td><td class=\"number\">{{ \"%.1f\"|format(totals.working_margin_percent or 0) }}%</td><td class=\"number\">{{ \"%.1f\"|format(totals.invoiced_margin_percent or 0) }}%</td><td class=\"number\">\u2014</td><td class=\"number\">\u2014</td></tr>\n    </tbody>\n  </table>\n  <div class=\"section-title\">Charge Breakdown: Quoted vs Working</div>\n  <table class=\"charge-table\">\n    <thead><tr><th style=\"width:25%;\">CHARGE</th><th style=\"width:12%;\">QUOTED REV</th><th style=\"width:12%;\">WORKING REV</th><th style=\"width:12%;\">VARIANCE</th><th style=\"width:12%;\">QUOTED COST</th><th style=\"width:12%;\">WORKING COST</th><th style=\"width:15%;\">VARIANCE</th></tr></thead>\n    <tbody>\n      {% for charge in cost_data.charges or [] %}<tr><td>{{ charge.charge }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.quoted_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.working_revenue or 0) }}</td><td class=\"number {% if (charge.working_revenue or 0) - (charge.quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((charge.working_revenue or 0) - (charge.quoted_revenue or 0)) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.quoted_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.working_cost or 0) }}</td><td class=\"number {% if (charge.working_cost or 0) - (charge.quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((charge.working_cost or 0) - (charge.quoted_cost or 0)) }}</td></tr>{% endfor %}\n      <tr class=\"total-row\"><td>TOTAL</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.quoted_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.working_revenue or 0) }}</td><td class=\"number {% if (cost_data.totals.working_revenue or 0) - (cost_data.totals.quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((cost_data.totals.working_revenue or 0) - (cost_data.totals.quoted_revenue or 0)) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.quoted_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.working_cost or 0) }}</td><td class=\"number {% if (cost_data.totals.working_cost or 0) - (cost_data.totals.quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((cost_data.totals.working_cost or 0) - (cost_data.totals.quoted_cost or 0)) }}</td></tr>\n    </tbody>\n  </table>\n  <div class=\"section-title\">Charge Breakdown: Quoted vs Invoiced (Variance Analysis)</div>\n  <table class=\"charge-table\">\n    <thead><tr><th style=\"width:25%;\">CHARGE</th><th style=\"width:12%;\">QUOTED REV</th><th style=\"width:12%;\">INVOICED REV</th><th style=\"width:12%;\">VARIANCE</th><th style=\"width:12%;\">QUOTED COST</th><th style=\"width:12%;\">INVOICED COST</th><th style=\"width:15%;\">VARIANCE</th></tr></thead>\n    <tbody>\n      {% for charge in cost_data.charges or [] %}<tr><td>{{ charge.charge }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.quoted_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.invoiced_revenue or 0) }}</td><td class=\"number {% if (charge.invoiced_revenue or 0) - (charge.quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((charge.invoiced_revenue or 0) - (charge.quoted_revenue or 0)) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.quoted_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(charge.invoiced_cost or 0) }}</td><td class=\"number {% if (charge.invoiced_cost or 0) - (charge.quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((charge.invoiced_cost or 0) - (charge.quoted_cost or 0)) }}</td></tr>{% endfor %}\n      <tr class=\"total-row\"><td>TOTAL</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.quoted_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.invoiced_revenue or 0) }}</td><td class=\"number {% if (cost_data.totals.invoiced_revenue or 0) - (cost_data.totals.quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((cost_data.totals.invoiced_revenue or 0) - (cost_data.totals.quoted_revenue or 0)) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.quoted_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(cost_data.totals.invoiced_cost or 0) }}</td><td class=\"number {% if (cost_data.totals.invoiced_cost or 0) - (cost_data.totals.quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((cost_data.totals.invoiced_cost or 0) - (cost_data.totals.quoted_cost or 0)) }}</td></tr>\n    </tbody>\n  </table>\n  <div class=\"section-title\">Party Breakdown: Customers</div>\n  <table class=\"party-table\">\n    <thead><tr><th style=\"width:25%;\">CUSTOMER</th><th style=\"width:15%;\">QUOTED REV</th><th style=\"width:15%;\">WORKING REV</th><th style=\"width:15%;\">INVOICED REV</th><th style=\"width:15%;\">VARIANCE</th><th style=\"width:15%;\">MARGIN %</th></tr></thead>\n    <tbody>\n      {% for party in party_data.customers or [] %}{% set margin = (party.invoiced_revenue or 0) - (party.invoiced_cost or 0) %}{% set margin_pct = (margin / (party.invoiced_revenue or 1) * 100) if (party.invoiced_revenue or 0) > 0 else 0 %}<tr><td>{{ party.party }}</td><td class=\"number\">{{ \"{:,.0f}\".format(party.quoted_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(party.working_revenue or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(party.invoiced_revenue or 0) }}</td><td class=\"number {% if (party.invoiced_revenue or 0) - (party.quoted_revenue or 0) >= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((party.invoiced_revenue or 0) - (party.quoted_revenue or 0)) }}</td><td class=\"number {% if margin_pct >= 0 %}positive{% else %}negative{% endif %}\">{{ \"%.1f\"|format(margin_pct) }}%</td></tr>{% endfor %}\n      <tr class=\"total-row\"><td>TOTAL CUSTOMERS</td><td class=\"number\">\u2014</td><td class=\"number\">\u2014</td><td class=\"number\">{{ \"{:,.0f}\".format(party_data.totals.invoiced_revenue or 0) }}</td><td class=\"number\">\u2014</td><td class=\"number\">\u2014</td></tr>\n    </tbody>\n  </table>\n  <div class=\"section-title\">Party Breakdown: Suppliers</div>\n  <table class=\"party-table\">\n    <thead><tr><th style=\"width:25%;\">SUPPLIER</th><th style=\"width:15%;\">QUOTED COST</th><th style=\"width:15%;\">WORKING COST</th><th style=\"width:15%;\">INVOICED COST</th><th style=\"width:15%;\">VARIANCE</th><th style=\"width:15%;\">% OF TOTAL COST</th></tr></thead>\n    <tbody>\n      {% for party in party_data.suppliers or [] %}{% set cost_pct = (party.invoiced_cost / (party_data.totals.invoiced_cost or 1) * 100) if (party_data.totals.invoiced_cost or 0) > 0 else 0 %}<tr><td>{{ party.party }}</td><td class=\"number\">{{ \"{:,.0f}\".format(party.quoted_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(party.working_cost or 0) }}</td><td class=\"number\">{{ \"{:,.0f}\".format(party.invoiced_cost or 0) }}</td><td class=\"number {% if (party.invoiced_cost or 0) - (party.quoted_cost or 0) <= 0 %}positive{% else %}negative{% endif %}\">{{ \"{:,.0f}\".format((party.invoiced_cost or 0) - (party.quoted_cost or 0)) }}</td><td class=\"number\">{{ \"%.1f\"|format(cost_pct) }}%</td></tr>{% endfor %}\n      <tr class=\"total-row\"><td>TOTAL SUPPLIERS</td><td class=\"number\">\u2014</td><td class=\"number\">\u2014</td><td class=\"number\">{{ \"{:,.0f}\".format(party_data.totals.invoiced_cost or 0) }}</td><td class=\"number\">\u2014</td><td class=\"number\">100.0%</td></tr>\n    </tbody>\n  </table>\n  <div style=\"margin-top: 20px; text-align: center; font-size: 9px; color: #999; border-top: 1px solid #ddd; padding-top: 10px;\"><p>Generated on {{ doc.date_created }} | {{ doc.currency or \"USD\" }} | FreightMas</p></div>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-11-08 23:17:39.204516",
 "modified_by": "Administrator",
 "module": "Forwarding Service",
 "name": "Forwarding Job Cost Sheet",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}